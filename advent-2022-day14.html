<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>day 14</title>
    <style type="text/css">
      body {
        font-family: monospace;
        background: #0f0f23;
        color: #cccccc;
        height: 100vh;
      }
      h1 {
        text-align: center;
      }
      path {
        fill: none;
        stroke: #cccccc;
        stroke-width: 2px;
      }
      circle {
        fill: #e5b567;
      }
      .grid {
        height: 100%;
        padding: 5ch;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
      }
      .column {
        display: flex;
        flex-grow: 1;
      }
      .cave-container {
        flex-grow: 1;
      }
      .text-column {
        padding: 2ch;
        flex-direction: column;
        justify-content: stretch;
      }
      textarea {
        color: #d6d6d6;
        width: 100%;
        background: #232323;
        flex-grow: 1;
      }
    </style>
  </head>
  <body>
    <div class="grid">
      <div class="column"><div class="cave-container"><svg></svg></div></div>
      <div class="column text-column">
        <div>
          <input type="radio" id="part1-radio" name="part" value="part1" />
          <label for="part1-radio">Part 1</label>
          <input type="radio" id="part2-radio" name="part" value="part2" checked/>
          <label for="part2-radio">Part 2</label>
        </div>
          <textarea>
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
490,34 -> 494,34
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
493,32 -> 497,32
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
458,132 -> 463,132
473,38 -> 487,38
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
482,76 -> 486,76
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
490,26 -> 494,26
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
469,171 -> 473,171
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
487,32 -> 491,32
472,168 -> 476,168
496,30 -> 500,30
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
459,151 -> 459,152 -> 468,152 -> 468,151
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
459,151 -> 459,152 -> 468,152 -> 468,151
496,34 -> 500,34
484,30 -> 488,30
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
451,132 -> 456,132
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
490,30 -> 494,30
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
461,129 -> 466,129
472,72 -> 472,73 -> 483,73 -> 483,72
481,32 -> 485,32
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
476,82 -> 480,82
454,129 -> 459,129
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
488,82 -> 492,82
487,28 -> 491,28
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
473,54 -> 481,54 -> 481,53
485,79 -> 489,79
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
479,85 -> 483,85
463,177 -> 467,177
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
462,135 -> 467,135
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
472,174 -> 476,174
469,135 -> 474,135
478,34 -> 482,34
479,79 -> 483,79
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
465,132 -> 470,132
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
448,135 -> 453,135
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
482,82 -> 486,82
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
484,34 -> 488,34
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
473,54 -> 481,54 -> 481,53
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
457,126 -> 462,126
475,177 -> 479,177
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
478,174 -> 482,174
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
472,72 -> 472,73 -> 483,73 -> 483,72
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
499,32 -> 503,32
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
481,177 -> 485,177
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
455,135 -> 460,135
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
472,72 -> 472,73 -> 483,73 -> 483,72
463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
502,34 -> 506,34
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
485,85 -> 489,85
475,171 -> 479,171
459,151 -> 459,152 -> 468,152 -> 468,151
491,85 -> 495,85
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51
463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165
465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101
470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88
493,28 -> 497,28
473,85 -> 477,85
493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114
469,177 -> 473,177
451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138
466,174 -> 470,174
          </textarea>
     </div>
    </div>

    <script type="text/javascript">
      const scale = 2;
      const AIR = 0;
      const ROCK = 1;
      const SAND = 2;
      const SAND_SOURCE_X = 500;
      const ANIMATION_DURATION_S = 5;
      const svg = document.querySelector('svg');
      const svgNamespace = 'http://www.w3.org/2000/svg';
      function parseInput() {
        const isPart1 = document.querySelector('input[name="part"]:checked').value == "part1";
        const puzzleInput = document.querySelector('textarea').value;
        const lines = puzzleInput.split('\n');
        const paths = [];
        let xmin, xmax;
        let ymin, ymax;
        lines.forEach(l => {
          l = l.replaceAll(' ', '');
          if (l.length > 0) {
            const points = l.split('->');
            const path = [];
            points.forEach(p => {
              const coords = p.split(',');
              const point = {
                x: parseInt(coords[0]),
                y: parseInt(coords[1])
              };
              if (xmin === undefined || point.x < xmin) {
                xmin = point.x;
              }
              if (xmax === undefined || point.x > xmax) {
                xmax = point.x;
              }
              if (ymin === undefined || point.y < ymin) {
                ymin = point.y;
              }
              if (ymax === undefined || point.y > ymax) {
                ymax = point.y;
              }
              path.push(point);
            });
            paths.push(path);
          }
        });
        if (!isPart1) {
          ymax += 3;
        } else {
          paths.forEach(p => {
            p.forEach(point => {
              point.x -= xmin;
            })
          });
        }
        const nx = Math.max(xmax, 2*SAND_SOURCE_X);
        const grid = new Array(nx);
        for (let i = 0; i < grid.length; i++) {
          grid[i] = new Uint8Array(ymax + 1);
          if (!isPart1) {
            grid[i][ymax - 1] = ROCK;
          }
        }
        for (let p = 0; p < paths.length; p++) {
          const points = paths[p];
          for (let k = 1; k < points.length; k++) {
            const point = points[k];
            if (points[k - 1].x == point.x) {
              let yi = points[k - 1].y;
              grid[point.x][yi] = ROCK;
              while (yi != point.y) {
                yi += Math.sign(point.y - yi);
                grid[point.x][yi] = ROCK;
              }
            } else {
              let xi = points[k - 1].x;
              grid[xi][point.y] = ROCK;
              while (xi != point.x) {
                xi += Math.sign(point.x - xi);
                grid[xi][point.y] = ROCK;
              }
            }
          }
        }
        return {grid, paths, xmin, xmax, ymin, ymax, isPart1};
      }
      function redrawCave(cave) {
        let d = '';
        cave.paths.forEach(p => {
          d += 'M ' + p[0].x * scale  + ',' + (p[0].y * scale) + ' ';
          p.forEach(point => {
            d += 'L ' + point.x * scale  + ',' + (point.y * scale) + ' ';
            prev = point;
          })
        });
        const x = document.createElementNS(svgNamespace, "path");
        x.setAttributeNS(null, "d", d);
        svg.innerHTML = '';
        svg.appendChild(x);
        svg.setAttribute("viewBox", ((cave.xmin - 5) * scale) + " " + (-scale) + " " + ((cave.xmax - cave.xmin + 15) * scale) + " " + ((cave.ymax + 1)*scale));
      }
      function stepSimulation(cave, grain) {
        let fellIntoAbyss = false;
        let blockedSource = false;
        let cameToRest = false;
        let path = [{x: grain.x, y: grain.y}];
        const grid = cave.grid;
        while (!cameToRest && !fellIntoAbyss && !blockedSource) {
          
          if (grain.y + 1 >= grid[0].length) {
            fellIntoAbyss = true;
            break;
          }
          if (grid[grain.x][grain.y + 1] == AIR) {
            grain.y += 1;
            path.push({x: grain.x, y: grain.y});
            continue;
          }
          if (grain.x - 1 < 0) {
            fellIntoAbyss = true;
            break;
          }
          if (grid[grain.x - 1][grain.y + 1] == AIR) {
            grain.x -= 1;
            grain.y += 1;
            path.push({x: grain.x, y: grain.y});
            continue;
          }
          if (grain.x + 1 >= grid.length) {
            path.push({x: grain.x, y: grain.y});
            fellIntoAbyss = true;
            break;
          }
          if (grid[grain.x + 1][grain.y + 1] == AIR) {
            grain.x += 1;
            grain.y += 1;
            path.push({x: grain.x, y: grain.y});
            continue;
          }
          if (grid[grain.x][grain.y] != AIR) {
            grain = path[path.length - 1];
            if (grain.x == SAND_SOURCE_X && grain.y == 0 && !cave.isPart1) {
              blockedSource = true;
              break;
            }
          }
          grid[grain.x][grain.y] = SAND;
          path.push({x: grain.x, y: grain.y});
          cameToRest = true;
        }
        return {fellIntoAbyss, cameToRest, blockedSource, path}
      }
      function newGrain(cave) {
        let x = SAND_SOURCE_X;
        if (cave.isPart1) {
          x -= cave.xmin;
        }
        return {x: x, y: 0};
      }
      function printCave(cave) {
        let s = '';
        const g = cave.grid;
        for (let i = 0; i < g[0].length; i++) {
          for (let j = 0; j < g.length; j++) {
            if (g[j][i] == ROCK) {
              s += '#';
            } else if (g[j][i] == SAND) {
              s += 'o';
            } else {
              s += ' ';
            }
          }
          s += '\n';
        }
        console.log(s);
      }
      function simulateSand(cave) {
        const grid = cave.grid;
        let done = false;
        let grain = newGrain(cave);
        let n = 0;
        let grainPaths = [];
        while (true) {
          result = stepSimulation(cave, grain);
          if (result.cameToRest) {
            grain = newGrain(cave);
            grainPaths.push(result.path);
            n++;
          } else if (result.fellIntoAbyss || result.blockedSource) {
            break;
          }
        }
        drawSand(cave, grainPaths);
        return n;
      }
      function drawSand(cave, grainPaths, animate) {
        let totalTime = 0;
        grainPaths.forEach(path => {
          totalTime += path.length;
        })
        let timeElapsed = 0;
        grainPaths.forEach(path => {
          const c = document.createElementNS(svgNamespace, "circle");
          cxInitial = path[0].x*scale;
          cxFinal = path[path.length - 1].x*scale;
          cyInitial = path[0].y*scale;
          cyFinal = path[path.length - 1].y*scale;
          c.setAttribute("cx", animate ? cxInitial : cxFinal);
          c.setAttribute("cy", animate ? cyInitial: cyFinal);
          c.setAttribute("r", scale/2);

          if (animate) {
            const xAnim = document.createElementNS(svgNamespace, "animate");
            xAnim.setAttribute("attributeName", "cx");
            let values = [];
            for (let t = 0; t < timeElapsed; t++) {
              values.push(cxInitial);
            }
            path.forEach(point => {
              values.push(point.x*scale);
            });
            while (values.length < totalTime) {
              values.push(cxFinal);
            }
            xAnim.setAttribute("values", values.join(';'));
            xAnim.setAttribute("dur", ANIMATION_DURATION_S + 's');
            xAnim.setAttribute("repeatCount", '1');
            xAnim.setAttribute("fill", 'freeze');
            xAnim.setAttribute("restart", "whenNotActive");
            c.appendChild(xAnim);

            const yAnim = document.createElementNS(svgNamespace, "animate");
            yAnim.setAttribute("attributeName", "cy");
            values = [];
            for (let t = 0; t < timeElapsed; t++) {
              values.push(cyInitial);
            }
            path.forEach(point => {
              values.push(point.y*scale);
            });
            while (values.length < totalTime) {
              values.push(cyFinal);
            }
            yAnim.setAttribute("values", values.join(';'));
            yAnim.setAttribute("dur", ANIMATION_DURATION_S + 's');
            yAnim.setAttribute("repeatCount", '1');
            yAnim.setAttribute("fill", 'freeze');
            yAnim.setAttribute("restart", "whenNotActive");
            c.appendChild(yAnim);

            timeElapsed += path.length;
          }
          svg.appendChild(c);
        });
      }

      function redraw() {
        const cave = parseInput();
        redrawCave(cave);
        const numGrains = simulateSand(cave);
        console.log(numGrains);
      }
      redraw();
      document.querySelector('textarea').addEventListener('change', redraw);
      // svg.addEventListener("click", (evt) => {
      //   document.querySelectorAll("animate").forEach((element) => {
      //     element.beginElement();
      //   });
      // });
    </script>
  </body>
</html>